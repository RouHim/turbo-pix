<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>TurboPix</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#4f46e5" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/components.css" />
    <link rel="stylesheet" href="/css/responsive.css" />
  </head>
  <body>
    <div id="app">
      <header class="header">
        <div class="header-content">
          <h1 class="logo">
            <a
              href="#"
              id="logo-link"
              style="text-decoration: none; color: inherit; display: flex; align-items: center"
              ><img
                src="/favicon.svg"
                alt="TurboPix logo"
                style="height: 2em; margin-right: 0.5em"
              />TurboPix</a
            >
          </h1>
          <div class="header-actions">
            <div class="search-container">
              <input
                type="text"
                id="search-input"
                placeholder="AI-powered photo search..."
                data-i18n-placeholder="ui.search_ai_placeholder"
                class="search-input"
              />
              <button id="search-btn" class="search-btn" data-i18n="ui.search">Search</button>
            </div>
            <button
              id="theme-toggle"
              class="theme-toggle"
              title="Toggle theme"
              data-i18n-title="ui.toggle_theme"
            >
              <span class="theme-icon"></span>
            </button>
          </div>
        </div>
      </header>

      <!-- Indexing Progress Banner -->
      <div id="indexing-banner" class="indexing-banner" style="display: none">
        <div class="indexing-banner-content">
          <i data-feather="camera" class="indexing-icon"></i>
          <div class="indexing-text">
            <span id="indexing-message" data-i18n="ui.indexing_photos">Indexing photos...</span>
            <span id="indexing-progress"></span>
          </div>
          <div class="indexing-progress-bar">
            <div id="indexing-progress-fill" class="indexing-progress-fill" style="width: 0%"></div>
          </div>
        </div>
      </div>

      <nav class="sidebar">
        <div class="sidebar-content">
          <button class="nav-item active" data-view="all" data-i18n="ui.all_photos">
            All Photos
          </button>
          <button class="nav-item" data-view="favorites" data-i18n="ui.favorites">Favorites</button>
          <button class="nav-item" data-view="videos" data-i18n="ui.videos">Videos</button>
          <button class="nav-item" data-view="collages" data-i18n="ui.collages">Collages</button>
          <button class="nav-item" data-view="cleanup" data-i18n="ui.cleanup">Cleanup</button>
        </div>
      </nav>

      <main class="main-content">
        <div class="content-header">
          <h2 id="current-view-title" data-i18n="ui.all_photos">All Photos</h2>
          <div class="content-actions">
            <select id="sort-select" class="sort-select">
              <option value="date_desc" data-i18n="ui.newest_first">Newest First</option>
              <option value="date_asc" data-i18n="ui.oldest_first">Oldest First</option>
              <option value="name_asc" data-i18n="ui.name_a_z">Name A-Z</option>
              <option value="name_desc" data-i18n="ui.name_z_a">Name Z-A</option>
              <option value="size_desc" data-i18n="ui.largest_first">Largest First</option>
              <option value="size_asc" data-i18n="ui.smallest_first">Smallest First</option>
            </select>
          </div>
        </div>

        <!-- Timeline Slider -->
        <div class="timeline-container">
          <!-- Desktop: Slider -->
          <div class="timeline-slider desktop-only">
            <button
              class="timeline-reset"
              title="Clear timeline filter"
              data-i18n-title="ui.clear_timeline_filter"
            >
              ✕
            </button>
            <div class="timeline-track">
              <canvas class="timeline-heatmap" width="800" height="40"></canvas>
              <input type="range" class="timeline-input" min="0" max="100" value="100" />
            </div>
            <div class="timeline-label" data-i18n="ui.all_dates">All Dates</div>
          </div>

          <!-- Mobile: Dropdowns -->
          <div class="timeline-dropdowns mobile-only">
            <select class="timeline-year-select">
              <option value="" data-i18n="ui.all_years">All Years</option>
            </select>
            <select class="timeline-month-select">
              <option value="" data-i18n="ui.all_months">All Months</option>
            </select>
            <button
              class="timeline-reset"
              title="Clear timeline filter"
              data-i18n-title="ui.clear_timeline_filter"
            >
              ✕
            </button>
          </div>
        </div>

        <div id="photo-grid" class="photo-grid">
          <div class="loading-skeleton">
            <div class="skeleton-item"></div>
            <div class="skeleton-item"></div>
            <div class="skeleton-item"></div>
            <div class="skeleton-item"></div>
            <div class="skeleton-item"></div>
            <div class="skeleton-item"></div>
          </div>
        </div>

        <div id="load-more-container" class="load-more-container">
          <button id="load-more-btn" class="load-more-btn" data-i18n="ui.load_more">
            Load More
          </button>
        </div>
      </main>
    </div>

    <!-- Photo Viewer Modal -->
    <div id="photo-viewer" class="photo-viewer">
      <div class="viewer-overlay"></div>
      <div class="viewer-content">
        <button
          class="viewer-close"
          title="Close"
          data-i18n-title="ui.close"
          data-icon="x"
        ></button>
        <button
          class="viewer-prev"
          title="Previous"
          data-i18n-title="ui.previous"
          data-icon="chevron-left"
        ></button>
        <button
          class="viewer-next"
          title="Next"
          data-i18n-title="ui.next"
          data-icon="chevron-right"
        ></button>

        <div class="viewer-controls">
          <button
            class="zoom-btn zoom-out"
            title="Zoom Out"
            data-i18n-title="ui.zoom_out"
            data-icon="minus"
          ></button>
          <button
            class="zoom-btn zoom-in"
            title="Zoom In"
            data-i18n-title="ui.zoom_in"
            data-icon="plus"
          ></button>
          <button
            class="zoom-btn zoom-fit"
            title="Fit to Screen"
            data-i18n-title="ui.fit_to_screen"
            data-icon="minimize"
          ></button>
          <button
            class="zoom-btn fullscreen-btn"
            title="Fullscreen"
            data-i18n-title="ui.fullscreen"
            data-icon="maximize"
          ></button>
          <button
            class="zoom-btn favorite-btn"
            title="Add to Favorites"
            data-i18n-title="ui.add_to_favorites"
            data-icon="heart"
          ></button>
          <button
            class="zoom-btn download-btn"
            title="Download"
            data-i18n-title="ui.download"
            data-icon="download"
          ></button>
          <button
            class="zoom-btn metadata-btn"
            title="View Details"
            data-i18n-title="ui.view_details"
            data-icon="info"
          ></button>
          <button
            class="zoom-btn rotate-left-btn"
            title="Rotate Left 90°"
            data-i18n-title="ui.rotate_left"
            data-icon="rotate-ccw"
          ></button>
          <button
            class="zoom-btn rotate-right-btn"
            title="Rotate Right 90°"
            data-i18n-title="ui.rotate_right"
            data-icon="rotate-cw"
          ></button>
          <button
            class="zoom-btn delete-photo-btn"
            title="Delete Photo"
            data-i18n-title="ui.delete_photo"
            data-icon="trash-2"
            style="margin-left: auto; color: #ef4444;"
          ></button>
        </div>

        <div class="viewer-main">
          <img id="viewer-image" class="viewer-image" alt="Photo" data-i18n-alt="ui.photo" />
          <video id="viewer-video" class="viewer-video" controls style="display: none"></video>
          <div class="viewer-loading-indicator">
            <div class="spinner"></div>
          </div>
        </div>

        <div class="viewer-sidebar">
          <div class="photo-info">
            <div style="display: flex; justify-content: space-between; align-items: center">
              <h3 id="photo-title" data-i18n="ui.photo_title">Photo Title</h3>
              <button
                id="metadata-edit-btn"
                class="btn-icon"
                title="Edit Metadata"
                style="display: none"
              >
                <i data-feather="edit-2"></i>
              </button>
            </div>

            <div class="photo-meta">
              <div class="meta-item">
                <label data-i18n="ui.date">Date:</label>
                <span id="photo-date">-</span>
              </div>
              <div class="meta-item">
                <label data-i18n="ui.size">Size:</label>
                <span id="photo-size">-</span>
              </div>
              <div class="meta-item">
                <label data-i18n="ui.camera">Camera:</label>
                <span id="photo-camera">-</span>
              </div>
              <div class="meta-item">
                <label data-i18n="ui.location">Location:</label>
                <span id="photo-location">-</span>
              </div>
            </div>

            <div class="photo-meta-full">
              <div class="meta-section">
                <h4 class="meta-section-title" data-i18n="ui.metadata.file_information">
                  File Information
                </h4>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.file_path">File path:</label>
                  <span id="meta-filename">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.file_size">File Size:</label>
                  <span id="meta-filesize">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.dimensions">Dimensions:</label>
                  <span id="meta-dimensions">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.type">Type:</label>
                  <span id="meta-type">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.date_taken">Date Taken:</label>
                  <span id="meta-date-taken">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.date_modified">Date Modified:</label>
                  <span id="meta-date-modified">-</span>
                </div>
              </div>

              <div class="meta-section" id="camera-section">
                <h4 class="meta-section-title" data-i18n="ui.metadata.camera_section">Camera</h4>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.make">Make:</label>
                  <span id="meta-camera-make">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.model">Model:</label>
                  <span id="meta-camera-model">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.lens_make">Lens Make:</label>
                  <span id="meta-lens-make">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.lens_model">Lens Model:</label>
                  <span id="meta-lens-model">-</span>
                </div>
              </div>

              <div class="meta-section" id="settings-section">
                <h4 class="meta-section-title" data-i18n="ui.metadata.camera_settings">
                  Camera Settings
                </h4>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.iso">ISO:</label>
                  <span id="meta-iso">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.aperture">Aperture:</label>
                  <span id="meta-aperture">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.shutter_speed">Shutter Speed:</label>
                  <span id="meta-shutter">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.focal_length">Focal Length:</label>
                  <span id="meta-focal">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.exposure_mode">Exposure Mode:</label>
                  <span id="meta-exposure">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.metering_mode">Metering Mode:</label>
                  <span id="meta-metering">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.white_balance">White Balance:</label>
                  <span id="meta-wb">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.flash">Flash:</label>
                  <span id="meta-flash">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.orientation">Orientation:</label>
                  <span id="meta-orientation">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.color_space">Color Space:</label>
                  <span id="meta-colorspace">-</span>
                </div>
              </div>

              <div class="meta-section" id="location-section">
                <h4 class="meta-section-title" data-i18n="ui.metadata.location_section">
                  Location
                </h4>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.gps">GPS:</label>
                  <span id="meta-gps">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.location_name">Location Name:</label>
                  <span id="meta-location-name">-</span>
                </div>
              </div>

              <div class="meta-section" id="video-section" style="display: none">
                <h4 class="meta-section-title" data-i18n="ui.metadata.video_section">
                  Video Information
                </h4>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.duration">Duration:</label>
                  <span id="meta-duration">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.video_codec">Video Codec:</label>
                  <span id="meta-video-codec">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.audio_codec">Audio Codec:</label>
                  <span id="meta-audio-codec">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.frame_rate">Frame Rate:</label>
                  <span id="meta-framerate">-</span>
                </div>
                <div class="meta-item">
                  <label data-i18n="ui.metadata.bitrate">Bitrate:</label>
                  <span id="meta-bitrate">-</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loading-indicator" class="loading-indicator">
      <div class="spinner"></div>
      <span data-i18n="ui.loading">Loading...</span>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Metadata Edit Modal -->
    <div id="metadata-edit-modal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h2 data-i18n="ui.metadata.edit_modal_title">Edit Photo Metadata</h2>
          <button id="metadata-edit-close" class="close-button" aria-label="Close">&times;</button>
        </div>
        <form id="metadata-edit-form">
          <div class="form-group">
            <label for="edit-taken-at" data-i18n="ui.metadata.edit_date_label">Date Taken</label>
            <input type="datetime-local" id="edit-taken-at" name="taken_at" />
          </div>
          <div class="form-group-row">
            <div class="form-group">
              <label for="edit-latitude" data-i18n="ui.metadata.edit_latitude_label"
                >Latitude</label
              >
              <input
                type="number"
                id="edit-latitude"
                name="latitude"
                step="any"
                min="-90"
                max="90"
                placeholder="-90 to 90"
              />
            </div>
            <div class="form-group">
              <label for="edit-longitude" data-i18n="ui.metadata.edit_longitude_label"
                >Longitude</label
              >
              <input
                type="number"
                id="edit-longitude"
                name="longitude"
                step="any"
                min="-180"
                max="180"
                placeholder="-180 to 180"
              />
            </div>
          </div>
          <div id="metadata-edit-error" class="error-message" style="display: none"></div>
          <div class="modal-actions">
            <button
              type="button"
              id="metadata-edit-cancel"
              class="btn-secondary"
              data-i18n="ui.metadata.edit_cancel"
            >
              Cancel
            </button>
            <button
              type="submit"
              id="metadata-edit-save"
              class="btn-primary"
              data-i18n="ui.metadata.edit_save"
            >
              Save
            </button>
          </div>
        </form>
      </div>
    </div>

    <script src="/js/feather.min.js"></script>
    <script src="/js/icons.js"></script>
    <script src="/js/constants.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/logger.js"></script>
    <script src="/js/blurhash.js"></script>
    <script src="/i18n/i18nManager.js"></script>
    <script src="/i18n/en/index.js"></script>
    <script src="/i18n/de/index.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/indexingStatus.js"></script>
    <script src="/js/gestureRecognizers.js"></script>
    <script src="/js/gestureManager.js"></script>
    <script src="/js/viewerControls.js"></script>
    <script src="/js/viewerMetadata.js"></script>
    <script src="/js/viewerMetadataEdit.js"></script>
    <script src="/js/photoCard.js"></script>
    <script src="/js/infiniteScroll.js"></script>
    <script src="/js/photoGrid.js"></script>
    <script src="/js/viewer.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/timeline.js"></script>
    <script src="/js/collages.js"></script>
    <script src="/js/cleanup.js"></script>
    <script src="/js/app.js"></script>
  </body>
</html>
